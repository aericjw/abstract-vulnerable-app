(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{15:function(t,e,a){},50:function(t,e,a){"use strict";a.r(e);var s=a(2),n=a.n(s),c=a(24),i=a.n(c),o=(a(15),a(7)),r=a(8),l=a(4),u=a(11),h=a(10),d=a(9),p=a.n(d),b=a(0),m=function(t){Object(u.a)(a,t);var e=Object(h.a)(a);function a(t){var s;return Object(o.a)(this,a),s=e.call(this,t),p()(Object(l.a)(s)),s}return Object(r.a)(a,[{key:"render",value:function(){return!0===this.props.disabled?Object(b.jsx)("button",{className:"p-2 rounded-xl bg-white bg-opacity-25",disabled:this.props.disabled,onClick:this.props.onClick,children:this.props.children}):Object(b.jsx)("button",{className:"p-2 rounded-xl bg-white",disabled:this.props.disabled,onClick:this.props.onClick,children:this.props.children})}}]),a}(n.a.Component),g=a(3),x=a.n(g),j=a(12),f=a(13),k=a.n(f);function v(t){return y.apply(this,arguments)}function y(){return y=Object(j.a)(x.a.mark((function t(e){var a,s=arguments;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:T(),console.log(a),t.prev=2,t.next=5,k.a.get("".concat(a,"/api/").concat(e.requestType),JSON.stringify(e));case 5:return t.abrupt("return",t.sent);case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[2,8]])}))),y.apply(this,arguments)}function O(t){return S.apply(this,arguments)}function S(){return S=Object(j.a)(x.a.mark((function t(e){var a,s=arguments;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:T(),console.log(a),t.prev=2,t.next=5,k.a.put("".concat(a,"/api/").concat(e.requestType),JSON.stringify(e));case 5:return t.abrupt("return",t.sent);case 8:return t.prev=8,t.t0=t.catch(2),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[2,8]])}))),S.apply(this,arguments)}function T(){var t=window.location.protocol,e=window.location.hostname,a=window.location.port,s=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SERVER_PORT;return"".concat(t,"//").concat(e,":").concat(s||a)}var w=function(t){Object(u.a)(a,t);var e=Object(h.a)(a);function a(t){var s;return Object(o.a)(this,a),s=e.call(this,t),p()(Object(l.a)(s)),s.state={pageType:"instruction",attackType:"",accountNumber:-1,amountStolen:0,amountToSteal:0,timeLeft:20,chanceDetect:0,isDetected:!1,static:!0,accounts:[[1,1,"Savings",1e8],[2,1,"Checking",1e5],[3,2,"Savings",15e5],[4,2,"Checking",2e5],[5,3,"Savings",2e6],[6,3,"Checking",4e4],[7,4,"Savings",1e3],[8,4,"Checking",800],[9,5,"Checking",2e3],[10,6,"Checking",3e5],[11,7,"Savings",2e4],[12,7,"Checking",3600],[13,8,"Savings",500],[14,8,"Checking",200],[15,9,"Savings",45e3],[16,10,"Savings",75e3],[17,10,"Checking",15e3]],indexes:[]},s}return Object(r.a)(a,[{key:"sql_request",value:function(){var t=this;if(this.state.static)this.setState({pageType:"options",attackType:"SQL",accountNumber:this.state.accounts[0][0],amountToSteal:this.state.accounts[0][3],timeLeft:this.state.timeLeft-3,chanceDetect:this.state.chanceDetect+5});else{v({requestType:"sql_inject"},T()).then((function(e){console.log(e.data),t.setState({pageType:"options",attackType:"SQL",accountNumber:e.data.account,amountToSteal:e.data.balance,timeLeft:t.state.timeLeft-3,chanceDetect:t.state.chanceDetect+5})}))}}},{key:"xss",value:function(){var t=this;if(this.state.static){var e=Math.floor(17*Math.random());this.state.indexes.push(e),this.setState({pageType:"options",attackType:"XSS",accountNumber:this.state.accounts[e-1][0],amountToSteal:this.state.accounts[e-1][3],timeLeft:this.state.timeLeft-3,chanceDetect:this.state.chanceDetect+5})}else{v({requestType:"xss"},T()).then((function(e){console.log(e.data),t.setState({pageType:"options",attackType:"XSS",accountNumber:e.data.account,amountToSteal:e.data.balance,timeLeft:t.state.timeLeft-3,chanceDetect:t.state.chanceDetect+5})}))}}},{key:"logout",value:function(){"zero"===this.state.pageType||this.state.timeLeft>0&&"options"===this.state.pageType?this.setState({pageType:"success"}):this.setState({pageType:"attack",attackType:"",accountNumber:-1,amountStolen:0,amountToSteal:0,timeLeft:20,chanceDetect:0,isDetected:!1,indexes:[]})}},{key:"steal",value:function(){var t=this;if(this.state.static){if("SQL"===this.state.attackType){var e=this.state.accountNumber,a=e+1>16?1:e+1;console.log("Current: "+e),console.log("Next: "+a),this.setState({amountStolen:this.state.amountStolen+this.state.amountToSteal,accountNumber:a,timeLeft:this.state.timeLeft-2,chanceDetect:this.state.chanceDetect+10,amountToSteal:this.state.accounts[a-1][3]},(function(){console.log(t.state),t.hasTimeExpired(),t.hasBeenDetected()}))}else if("XSS"===this.state.attackType){var s=Math.floor(17*Math.random());if(this.state.indexes.includes(s)){for(;this.state.indexes.includes(s);)s=Math.floor(17*Math.random());this.state.indexes.push(s)}else this.state.indexes.push(s);console.log("RandomIndex: "+s);var n=s;this.setState({amountStolen:this.state.amountStolen+this.state.amountToSteal,accountNumber:n,timeLeft:this.state.timeLeft-2,chanceDetect:this.state.chanceDetect+10,amountToSteal:this.state.accounts[n-1][3]},(function(){console.log(t.state),t.hasTimeExpired(),t.hasBeenDetected()}))}}else O({requestType:"steal",attackType:this.state.attackType,account:this.state.accountNumber},T()).then((function(e){console.log(e.data),t.setState({amountStolen:t.state.amountStolen+e.data.currentAccount.balance,accountNumber:e.data.nextAccount.account,timeLeft:t.state.timeLeft-2,chanceDetect:t.state.chanceDetect+10,amountToSteal:e.data.nextAccount.balance},(function(){console.log(t.state),t.hasTimeExpired(),t.hasBeenDetected()}))}))}},{key:"next",value:function(){var t=this;if(this.state.static){if("SQL"===this.state.attackType){var e=this.state.accountNumber,a=e+1>16?1:e+1;this.setState({accountNumber:a,timeLeft:this.state.timeLeft-2,amountToSteal:this.state.accounts[a-1][3]},(function(){console.log(t.state),t.hasTimeExpired(),t.hasBeenDetected()}))}else if("XSS"===this.state.attackType){var s=Math.floor(17*Math.random());if(this.state.indexes.includes(s)){for(;this.state.indexes.includes(s);)s=Math.floor(17*Math.random());this.state.indexes.push(s)}else this.state.indexes.push(s);var n=s;this.setState({accountNumber:n,timeLeft:this.state.timeLeft-2,amountToSteal:this.state.accounts[n-1][3]},(function(){console.log(t.state),t.hasTimeExpired(),t.hasBeenDetected()}))}}else O({requestType:"next",attackType:this.state.attackType,account:this.state.accountNumber},T()).then((function(e){console.log(e.data),t.setState({accountNumber:e.data.nextAccount.account,timeLeft:t.state.timeLeft-1,amountToSteal:e.data.nextAccount.balance},(function(){console.log(t.state),t.hasTimeExpired()}))}))}},{key:"hasTimeExpired",value:function(){this.state.timeLeft<0?(console.log("Attacker was caught"),this.setState({pageType:"failure",timeLeft:0})):0===this.state.timeLeft&&(console.log("Logout?"),this.setState({pageType:"zero"}))}},{key:"hasBeenDetected",value:function(){this.state.chanceDetect>=100?this.setState({isDetected:!0}):this.setState({isDetected:Math.random()<this.state.chanceDetect/100}),this.state.isDetected&&(console.log("Attacker was caught"),this.setState({pageType:"failure",chanceDetect:100}))}},{key:"render_attacks",value:function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{className:"pb-2",children:"How do you want to attack?"}),Object(b.jsxs)("div",{className:"grid grid-rows-1 grid-flow-cli grid-clis-2 gap-2",children:[Object(b.jsx)(m,{onClick:this.sql_request,children:"SQL Injection"}),Object(b.jsx)(m,{onClick:this.xss,children:"XSS Attack"})]})]})}},{key:"render_options",value:function(t){return Object(b.jsxs)("div",{className:"grid grid-clis-3 gap-2",children:[Object(b.jsxs)("div",{className:"grid grid-flow-row grid-rows-3 grid-clis-1 gap-2",children:[Object(b.jsx)(m,{disabled:t,onClick:this.steal,children:"Withdraw"}),Object(b.jsx)(m,{disabled:t,onClick:this.next,children:"Next"}),Object(b.jsx)(m,{onClick:this.logout,children:"Logout"})]}),Object(b.jsx)("div",{className:"cli-span-2",children:Object(b.jsxs)("div",{className:"grid grid-flow-row grid-rows-3 grid-clis-1",children:[Object(b.jsx)("p",{className:"p-2 text-left text-xl text-white font-medium bg-black rounded-t-xl",children:"Account #"+this.state.accountNumber}),Object(b.jsx)("p",{className:"p-2 text-left text-lg font-medium bg-white",children:"Balance:"}),Object(b.jsx)("p",{className:"p-2 text-right text-2xl font-blid bg-white rounded-b-xl",children:"$"+this.state.amountToSteal})]})})]})}},{key:"page_handler",value:function(){var t=this;return"attack"===this.state.pageType?this.render_attacks():"options"===this.state.pageType?this.render_options(!1):"zero"===this.state.pageType?this.render_options(!0):"failure"===this.state.pageType?Object(b.jsxs)("div",{className:"p-8 text-center",children:[Object(b.jsx)("p",{className:"p-2",children:"You were caught!"}),Object(b.jsx)(m,{onClick:function(){return t.logout()},children:"Start Over"})]}):"success"===this.state.pageType?Object(b.jsxs)("div",{className:"p-8 text-center",children:[Object(b.jsx)("p",{className:"p-2",children:"Congrats! You escaped successfully"}),Object(b.jsx)(m,{onClick:function(){return t.logout()},children:"Start Over"})]}):void 0}},{key:"render_title",value:function(){return Object(b.jsx)("div",{className:"p-2 bg-green-400 text-center text-black rounded-t-xl",children:Object(b.jsx)("p",{children:"Vulnerable Banking App"})})}},{key:"render_stats",value:function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"p-2 bg-red-400 text-center text-black rounded-t-xl",children:Object(b.jsx)("p",{children:"Attack Stats"})}),Object(b.jsxs)("div",{className:"p-2 bg-gray-300 text-center text-black rounded-b-xl",children:[Object(b.jsx)("p",{children:"Amount Stolen: $"+this.state.amountStolen}),Object(b.jsx)("p",{children:"Time Left: "+this.state.timeLeft+" mins"}),Object(b.jsx)("p",{children:"Chance of Detection: "+this.state.chanceDetect+"%"})]})]})}},{key:"render_instructions",value:function(){var t=this;return Object(b.jsxs)("div",{className:"pt-8 container mx-auto text-center",children:[Object(b.jsx)("div",{className:"p-2 bg-blue-400 text-center text-black rounded-t-xl",children:Object(b.jsx)("p",{children:"Instructions"})}),Object(b.jsxs)("div",{className:"p-2 bg-gray-300 text-black rounded-b-xl",children:[Object(b.jsx)("p",{className:"text-center",children:"Welcome to our vulnerable banking app! (abstracted version)"}),Object(b.jsx)("p",{className:"text-center",children:"As a way to demonstrate our concept for a research platform we developed an abstract version of a vulnerable app that hackers would break into and steal money from."}),Object(b.jsx)("p",{children:"Our game is quite simple."}),Object(b.jsx)("br",{}),Object(b.jsx)("p",{className:"text-center",children:"Your goal is to steal as much money as you can without getting caught, but there are a few rules:"}),Object(b.jsx)("br",{}),Object(b.jsxs)("ul",{className:"list-decimal pl-5 text-left",children:[Object(b.jsx)("li",{children:'You have 20 "minutes" to achieve your goal'}),Object(b.jsx)("li",{children:"You must choose your method of attack. An SQL injection will go through each bank account to steal from sequentially, while an XSS attack will pick random bank accounts to steal from"}),Object(b.jsx)("li",{children:'Each attack will take 3 "minutes" and as well raise your chances of getting caught'}),Object(b.jsx)("li",{children:'You will then be presented with a bank account and the options: "Withdraw" (stealing), "Next" (skipping) or "Log Out" (escape)'}),Object(b.jsx)("li",{children:'Stealing will take 2 "minutes" and skipping will take 1 "minute"'}),Object(b.jsx)("li",{children:"Your chances of getting caught go up for stealing. Your chances remain the same if you skip the account"}),Object(b.jsx)("li",{children:"Logging out finishes the game. You would want to do this if you feel like you have stolen enough money or feel like your chances of getting caught are too high"}),Object(b.jsx)("li",{children:'It is random chance you are caught based on your probability displayed in the "Attack Stats" section, and if you run out of time you will also be caught'})]}),Object(b.jsx)("br",{}),Object(b.jsx)("p",{className:"text-center",children:"A note about future work:"}),Object(b.jsx)("br",{}),Object(b.jsx)("p",{className:"text-left",children:"In this current stage, this is a static web app. It is not connect to a server or database for demonstration purposes. In reality we want to build a functional web application that mimics a real-world banking application but is extremely vulnerable. Vulnerable applications exist for white-hat hackers of various expertises to test and review their skills. It would be nice to use these but they are not fitted to our research since they don't have a real-life context and are often giving instructions on how to break them. While we may use similar ideas to these vulnerable applications we felt it would be best to have something more custom that can work and be flexible for whichever direction our research goes."}),Object(b.jsx)(m,{onClick:function(){return t.setState({pageType:"attack"})},children:"Start!"})]})]})}},{key:"render",value:function(){return"instruction"===this.state.pageType?Object(b.jsx)(b.Fragment,{children:this.render_instructions()}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("div",{className:"pt-8 container mx-auto text-center",children:this.render_title()}),Object(b.jsx)("div",{className:"p-2 container mx-auto bg-gray-300 rounded-b-xl text-center",children:this.page_handler()}),Object(b.jsx)("div",{className:"pt-8 container mx-auto text-center",children:this.render_stats()})]})}}]),a}(n.a.Component);i.a.render(Object(b.jsx)(n.a.StrictMode,{children:Object(b.jsx)(w,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.1c07bdae.chunk.js.map